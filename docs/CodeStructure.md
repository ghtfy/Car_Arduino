# 코드 구조 및 주요알고리즘

## 코드 구성

이 프로젝트의 주요 코드 파일들은 다음과 같습니다:

- **main.py**: 자율주행 시스템의 핵심 파일로, OpenCV를 사용하여 차선 인식, 보행자 인식, 신호등 및 표지판 인식 기능을 처리합니다.
- **control.py**: 아두이노와의 시리얼 통신을 통해 모터를 제어하며 차량의 이동을 관리합니다.
- **camera.py**: 카메라 모듈을 통해 실시간 영상을 캡처합니다.
- **pedestrian_detection.py**: HOG 디스크립터를 사용하여 보행자 인식 기능을 처리합니다.
- **lane_detection.py**: Canny 엣지 검출 및 Hough 변환을 이용한 차선 인식 기능을 처리합니다.

## 코드 흐름

1. `main.py`에서 차량의 자율주행을 위한 핵심 로직을 실행합니다.
2. 카메라에서 받아온 영상은 OpenCV로 처리되어 차선, 보행자, 신호등 등을 인식합니다.
3. 인식된 데이터를 바탕으로 `control.py`가 아두이노에 제어 명령을 보내고, 차량을 주행시킵니다.

## 주요 알고리즘

### 1. 차선 인식 (Lane Detection)

차선 인식은 차량이 도로에서 차선을 따라 주행할 수 있도록 도와주는 핵심 알고리즘입니다. 이 알고리즘은 Canny 엣지 검출과 Hough 변환을 사용하여 차선을 인식하고, 이를 통해 차량의 진행 방향을 결정합니다.

#### 알고리즘 흐름:
1. **Canny 엣지 검출 (Edge Detection)**:
   - Canny 엣지 검출을 사용하여 도로의 경계를 감지합니다.
   - 엣지 검출된 이미지는 차선 인식에 중요한 정보를 제공합니다.
   
2. **Hough 변환 (Hough Transform)**:
   - Canny 엣지 검출로 얻어진 엣지 이미지를 바탕으로 Hough 변환을 사용하여 직선을 검출합니다.
   - Hough 변환은 직선의 방정식에 맞는 모든 가능한 직선을 찾는 기법입니다.

3. **각도 계산 및 차선 분류**:
   - 검출된 직선의 각도를 계산하고, 차선의 왼쪽과 오른쪽을 구분합니다.
   - 차선의 평균 각도를 계산하여 차량의 주행 방향을 결정합니다.

---

### 2. 보행자 인식 (Pedestrian Detection)

보행자 인식 알고리즘은 차량이 보행자를 감지하고, 이를 통해 보행자와의 충돌을 방지할 수 있도록 돕습니다. 이 알고리즘은 HOG (Histogram of Oriented Gradients) 디스크립터를 사용하여 보행자를 검출합니다.

#### 알고리즘 흐름:
1. **HOG 디스크립터 (HOG Descriptor)**:
   - 영상에서 보행자와 같은 객체를 인식하기 위해 HOG 특성을 추출합니다.
   - HOG는 객체의 윤곽을 정의하는데 유용한 특성을 제공합니다.

2. **non-maximum suppression (겹침 제거)**:
   - 중복된 보행자 검출을 제거하기 위해 non-maximum suppression 기법을 적용합니다.
   - 이 방법을 통해 정확한 보행자 위치를 찾을 수 있습니다.

3. **보행자 검출 및 상태 출력**:
   - 보행자가 검출되면, 차량에 정지 신호를 보내고, "보행자 감지: 정지" 메시지를 출력합니다.
   - 보행자가 없으면 차량이 주행을 계속하도록 "보행자 없음: 주행 중" 메시지를 출력합니다.

---

### 3. 신호등 인식 (Traffic Light Detection)

신호등 인식은 차량이 교차로를 통과할 때 신호등의 색상을 인식하여 차량을 제어하는 알고리즘입니다. HSV 색상 공간을 사용하여 빨간색, 노란색, 초록색을 인식합니다.

#### 알고리즘 흐름:
1. **HSV 색상 공간 (HSV Color Space)**:
   - RGB 색상 공간에서 HSV 색상 공간으로 변환하여 색상의 범위를 지정합니다.
   - 이 방법은 색상의 밝기, 채도, 색상도를 분리하여 더 정확하게 색상을 감지할 수 있습니다.

2. **색상 범위 지정**:
   - 각 신호등 색상의 범위를 설정하여 빨간색, 노란색, 초록색을 인식합니다.
   - 신호등의 색상에 맞는 범위의 픽셀을 추출합니다.

3. **색상 감지 및 제어**:
   - 인식된 색상에 따라 차량이 신호등에 맞는 제어를 하도록 신호를 보냅니다.
   - 예를 들어, 빨간 신호를 감지하면 차량을 정지시키고, 초록 신호는 차량이 계속 주행할 수 있도록 합니다.

---

### 4. 표지판 인식 (Traffic Sign Detection)

표지판 인식 알고리즘은 도로의 표지판을 인식하여 차량의 주행을 제어하는 알고리즘입니다. 이 알고리즘은 경계선 검출과 딥러닝을 활용하여 표지판을 인식합니다.

#### 알고리즘 흐름:
1. **경계선 감지 (Edge Detection)**:
   - 이미지를 그레이스케일로 변환하고, 가우시안 블러 및 Canny 엣지 검출을 적용하여 경계선을 감지합니다.

2. **표지판 경계선 찾기**:
   - `cv2.findContours`를 사용하여 이미지에서 표지판의 경계선을 찾습니다.
   - `cv2.approxPolyDP`를 사용하여 표지판의 꼭짓점을 추정하고, 이를 이미지에 그려 시각적으로 표시합니다.

3. **딥러닝 기법 활용 (Optional)**:
   - 딥러닝 모델을 사용하여 표지판을 더 정확하게 인식할 수 있습니다.
   - 이를 통해 다양한 표지판을 정확하게 감지할 수 있으며, 차량에 필요한 제어 명령을 보낼 수 있습니다.


## 실행 방법

1. 라즈베리파이에서 `main.py` 파일을 실행하여 차량을 시작합니다.
   ```bash
   python3 main.py

